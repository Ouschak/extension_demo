var l=Object.defineProperty;var i=(o,e,t)=>e in o?l(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var n=(o,e,t)=>i(o,typeof e!="symbol"?e+"":e,t);const d="http://161.97.107.249:8000/api/v1";class h{constructor(e=d){n(this,"baseUrl");this.baseUrl=e}async analyzeText(e,t=!1){try{const r=await fetch(`${this.baseUrl}/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,check_soft_harassment:t})});if(!r.ok)throw new Error(`API error: ${r.status}`);return await r.json()}catch(r){throw console.error("[CreatorShield] API analyze error:",r),r}}async sendFeedback(e,t,r){try{if(!(await fetch(`${this.baseUrl}/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e,platform:t,correction:r})})).ok)throw new Error("Failed to send feedback")}catch(a){console.error("[CreatorShield] Feedback error:",a)}}}const c=new h;console.log("[CreatorShield] Background service worker started");chrome.runtime.onMessage.addListener((o,e,t)=>{if(o.type==="ANALYZE_TEXT"){let r=!1;return o.payload.checkSoftHarassment!==void 0?(r=o.payload.checkSoftHarassment,console.log(`[Background] ðŸŸ¢ DECISION: Using Payload Flag -> ${r}`)):console.log("[Background] ï¿½ PAYLOAD FLAG UNDEFINED. Defaulting to False."),c.analyzeText(o.payload.text,r).then(a=>{t(a)}).catch(a=>{console.error("Analysis error:",a),t({error:a.message})}),!0}if(o.type==="SEND_FEEDBACK"){const{content:r,platform:a,correction:s}=o.payload;return c.sendFeedback(r,a,s).then(()=>t({success:!0})).catch(()=>t({success:!1})),!0}});
