var K=Object.defineProperty;var Q=(e,t,n)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var I=(e,t,n)=>Q(e,typeof t!="symbol"?t+"":t,n);import{r as w,g as X,R as H,c as Y,j as s,a as k}from"./auth.service-uPo6PJsv.js";import{a as Z}from"./api.service-B0GcXazJ.js";class q{constructor(){I(this,"ws",null);I(this,"url","ws://localhost:8000/api/v1/ws");I(this,"reconnectInterval",5e3);I(this,"listeners",[])}connect(t){this.ws||(this.ws=new WebSocket(`${this.url}/${t}`),this.ws.onopen=()=>{console.log("[CreatorShield] WS Connected")},this.ws.onmessage=n=>{console.log("[CreatorShield] WS Message:",n.data);try{const a=JSON.parse(n.data);this.notifyListeners(a)}catch(a){console.error("WS Parse Error",a)}},this.ws.onclose=()=>{console.log("[CreatorShield] WS Disconnected"),this.ws=null,setTimeout(()=>this.connect(t),this.reconnectInterval)})}disconnect(){this.ws&&(this.ws.close(),this.ws=null)}subscribe(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(n=>n!==t)}}notifyListeners(t){this.listeners.forEach(n=>n(t))}}const L=new q,V={},P=e=>{let t;const n=new Set,a=(v,S)=>{const p=typeof v=="function"?v(t):v;if(!Object.is(p,t)){const m=t;t=S??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(f=>f(t,m))}},o=()=>t,g={setState:a,getState:o,getInitialState:()=>d,subscribe:v=>(n.add(v),()=>n.delete(v)),destroy:()=>{(V?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(a,o,g);return g},ee=e=>e?P(e):P;var O={exports:{}},W={},F={exports:{}},M={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E=w;function te(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var se=typeof Object.is=="function"?Object.is:te,ne=E.useState,re=E.useEffect,oe=E.useLayoutEffect,ae=E.useDebugValue;function ie(e,t){var n=t(),a=ne({inst:{value:n,getSnapshot:t}}),o=a[0].inst,r=a[1];return oe(function(){o.value=n,o.getSnapshot=t,T(o)&&r({inst:o})},[e,n,t]),re(function(){return T(o)&&r({inst:o}),e(function(){T(o)&&r({inst:o})})},[e]),ae(n),n}function T(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!se(e,n)}catch{return!0}}function le(e,t){return t()}var ce=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?le:ie;M.useSyncExternalStore=E.useSyncExternalStore!==void 0?E.useSyncExternalStore:ce;F.exports=M;var de=F.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D=w,ue=de;function me(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fe=typeof Object.is=="function"?Object.is:me,he=ue.useSyncExternalStore,xe=D.useRef,ge=D.useEffect,ve=D.useMemo,pe=D.useDebugValue;W.useSyncExternalStoreWithSelector=function(e,t,n,a,o){var r=xe(null);if(r.current===null){var h={hasValue:!1,value:null};r.current=h}else h=r.current;r=ve(function(){function g(m){if(!d){if(d=!0,v=m,m=a(m),o!==void 0&&h.hasValue){var f=h.value;if(o(f,m))return S=f}return S=m}if(f=S,fe(v,m))return f;var c=a(m);return o!==void 0&&o(f,c)?(v=m,f):(v=m,S=c)}var d=!1,v,S,p=n===void 0?null:n;return[function(){return g(t())},p===null?void 0:function(){return g(p())}]},[t,n,a,o]);var x=he(e,r[0],r[1]);return ge(function(){h.hasValue=!0,h.value=x},[x]),pe(x),x};O.exports=W;var be=O.exports;const Se=X(be),U={},{useDebugValue:ye}=H,{useSyncExternalStoreWithSelector:we}=Se;let z=!1;const je=e=>e;function Ne(e,t=je,n){(U?"production":void 0)!=="production"&&n&&!z&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),z=!0);const a=we(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return ye(a),a}const Ee=e=>{(U?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?ee(e):e,n=(a,o)=>Ne(t,a,o);return Object.assign(n,t),n},Ie=e=>Ee,_e={};function J(e,t){let n;try{n=e()}catch{return}return{getItem:o=>{var r;const h=g=>g===null?null:JSON.parse(g,void 0),x=(r=n.getItem(o))!=null?r:null;return x instanceof Promise?x.then(h):h(x)},setItem:(o,r)=>n.setItem(o,JSON.stringify(r,void 0)),removeItem:o=>n.removeItem(o)}}const _=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(a){return _(a)(n)},catch(a){return this}}}catch(n){return{then(a){return this},catch(a){return _(a)(n)}}}},Ce=(e,t)=>(n,a,o)=>{let r={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:i=>i,version:0,merge:(i,b)=>({...b,...i}),...t},h=!1;const x=new Set,g=new Set;let d;try{d=r.getStorage()}catch{}if(!d)return e((...i)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...i)},a,o);const v=_(r.serialize),S=()=>{const i=r.partialize({...a()});let b;const l=v({state:i,version:r.version}).then(y=>d.setItem(r.name,y)).catch(y=>{b=y});if(b)throw b;return l},p=o.setState;o.setState=(i,b)=>{p(i,b),S()};const m=e((...i)=>{n(...i),S()},a,o);let f;const c=()=>{var i;if(!d)return;h=!1,x.forEach(l=>l(a()));const b=((i=r.onRehydrateStorage)==null?void 0:i.call(r,a()))||void 0;return _(d.getItem.bind(d))(r.name).then(l=>{if(l)return r.deserialize(l)}).then(l=>{if(l)if(typeof l.version=="number"&&l.version!==r.version){if(r.migrate)return r.migrate(l.state,l.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return l.state}).then(l=>{var y;return f=r.merge(l,(y=a())!=null?y:m),n(f,!0),S()}).then(()=>{b==null||b(f,void 0),h=!0,g.forEach(l=>l(f))}).catch(l=>{b==null||b(void 0,l)})};return o.persist={setOptions:i=>{r={...r,...i},i.getStorage&&(d=i.getStorage())},clearStorage:()=>{d==null||d.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>c(),hasHydrated:()=>h,onHydrate:i=>(x.add(i),()=>{x.delete(i)}),onFinishHydration:i=>(g.add(i),()=>{g.delete(i)})},c(),f||m},ke=(e,t)=>(n,a,o)=>{let r={storage:J(()=>localStorage),partialize:c=>c,version:0,merge:(c,i)=>({...i,...c}),...t},h=!1;const x=new Set,g=new Set;let d=r.storage;if(!d)return e((...c)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...c)},a,o);const v=()=>{const c=r.partialize({...a()});return d.setItem(r.name,{state:c,version:r.version})},S=o.setState;o.setState=(c,i)=>{S(c,i),v()};const p=e((...c)=>{n(...c),v()},a,o);o.getInitialState=()=>p;let m;const f=()=>{var c,i;if(!d)return;h=!1,x.forEach(l=>{var y;return l((y=a())!=null?y:p)});const b=((i=r.onRehydrateStorage)==null?void 0:i.call(r,(c=a())!=null?c:p))||void 0;return _(d.getItem.bind(d))(r.name).then(l=>{if(l)if(typeof l.version=="number"&&l.version!==r.version){if(r.migrate)return[!0,r.migrate(l.state,l.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,l.state];return[!1,void 0]}).then(l=>{var y;const[C,$]=l;if(m=r.merge($,(y=a())!=null?y:p),n(m,!0),C)return v()}).then(()=>{b==null||b(m,void 0),m=a(),h=!0,g.forEach(l=>l(m))}).catch(l=>{b==null||b(void 0,l)})};return o.persist={setOptions:c=>{r={...r,...c},c.storage&&(d=c.storage)},clearStorage:()=>{d==null||d.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>f(),hasHydrated:()=>h,onHydrate:c=>(x.add(c),()=>{x.delete(c)}),onFinishHydration:c=>(g.add(c),()=>{g.delete(c)})},r.skipHydration||f(),m||p},De=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((_e?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Ce(e,t)):ke(e,t),$e=De,Re={getItem:async e=>{try{return(await chrome.storage.local.get(e))[e]??null}catch{return localStorage.getItem(e)}},setItem:async(e,t)=>{try{await chrome.storage.local.set({[e]:t})}catch{localStorage.setItem(e,t)}},removeItem:async e=>{try{await chrome.storage.local.remove(e)}catch{localStorage.removeItem(e)}}},Le=Ie()($e(e=>({enabled:!0,todayCount:0,toxicityScore:0,toggleEnabled:()=>e(t=>({enabled:!t.enabled})),incrementCount:()=>e(t=>({todayCount:t.todayCount+1})),updateToxicityScore:t=>e({toxicityScore:t}),resetDailyCount:()=>e({todayCount:0})}),{name:"creator-shield-detection-store",storage:J(()=>Re)}));function Te(e){if(!e)return"Just now";const t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/1e3);if(a<60)return"Just now";const o=Math.floor(a/60);if(o<60)return`${o}m ago`;const r=Math.floor(o/60);return r<24?`${r}h ago`:t.toLocaleDateString()}function Ae(){const[e,t]=w.useState(!1),[n,a]=w.useState(""),[o,r]=w.useState(""),[h,x]=w.useState({safe:0,toxic:0}),[g,d]=w.useState([]),[v,S]=w.useState("home"),[p,m]=w.useState(!1),[f,c]=w.useState(!1),{enabled:i,toggleEnabled:b}=Le();w.useEffect(()=>{l()},[]);const l=async()=>{await k.getToken()&&(t(!0),C(),y())},y=()=>{L.connect("user_123"),m(!0);const u=L.subscribe(j=>{if(j.type==="NEW_DETECTION"){const A={...j.payload,timestamp:new Date().toISOString(),is_new:!0};d(N=>[A,...N]),x(N=>({...N,toxic:N.toxic+1})),setTimeout(()=>{d(N=>N.map(R=>R===A?{...R,is_new:!1}:R))},2e3)}});return()=>{u(),m(!1)}},C=async()=>{const u=await Z.getLogs();d(u),x({safe:0,toxic:u.length})},$=async u=>{u.preventDefault(),f?await k.register(n,o)?(alert("Account created! Please sign in."),c(!1)):alert("Registration Failed"):await k.login(n,o)?(t(!0),C(),y()):alert("Login Failed")},B=async()=>{await k.logout(),t(!1),L.disconnect(),m(!1)},G=u=>{u&&window.open(u,"_blank")};return e?s.jsxs("div",{className:"flex flex-col h-screen bg-slate-50 font-sans text-slate-900",children:[s.jsxs("header",{className:"flex justify-between items-center p-4 bg-white shadow-sm border-b border-slate-100 sticky top-0 z-10",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("i",{className:"ri-shield-flash-fill text-indigo-600 text-xl"}),s.jsx("h1",{className:"font-bold text-slate-800",children:"Creator Shield"}),p&&s.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse",title:"Connected to Real-time AI"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:b,className:`relative w-10 h-5 rounded-full transition-colors ${i?"bg-indigo-500":"bg-slate-300"}`,title:i?"Protection Active":"Protection Disabled",children:s.jsx("div",{className:`absolute top-1 w-3 h-3 bg-white rounded-full transition-transform ${i?"left-6":"left-1"}`})}),s.jsx("button",{onClick:()=>S("home"),className:`p-2 rounded-lg transition-colors ${v==="home"?"bg-indigo-50 text-indigo-600":"text-slate-400 hover:text-slate-600"}`,children:s.jsx("i",{className:"ri-dashboard-line"})}),s.jsx("button",{onClick:B,className:"p-2 text-slate-400 hover:text-red-500 transition-colors",children:s.jsx("i",{className:"ri-logout-box-r-line"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex flex-col items-center",children:[s.jsx("div",{className:"p-2 bg-green-50 text-green-600 rounded-full mb-2",children:s.jsx("i",{className:"ri-check-double-line text-xl"})}),s.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.safe}),s.jsx("div",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Safe"})]}),s.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex flex-col items-center",children:[s.jsx("div",{className:"p-2 bg-red-50 text-red-600 rounded-full mb-2",children:s.jsx("i",{className:"ri-spam-3-line text-xl"})}),s.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.toxic}),s.jsx("div",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Toxic"})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("h2",{className:"font-bold text-slate-700",children:"Audit History"}),p&&s.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-green-100 text-green-700 rounded-full text-[10px] font-bold uppercase tracking-wide",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"Live"]})]}),s.jsx("div",{className:"space-y-3",children:g.length===0?s.jsxs("div",{className:"text-center py-8 text-slate-400 bg-white rounded-xl border border-dashed border-slate-200",children:[s.jsx("i",{className:"ri-inbox-line text-2xl mb-2 block"}),"No activity detected yet"]}):g.map((u,j)=>s.jsxs("div",{onClick:()=>G(u.url),className:`
                                        bg-white p-3 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-all group cursor-pointer relative overflow-hidden
                                        ${u.is_new?"ring-2 ring-indigo-500 bg-indigo-50":""}
                                    `,children:[u.is_new&&s.jsx("div",{className:"absolute top-0 right-0 p-1 bg-indigo-500 rounded-bl-lg text-[8px] text-white font-bold uppercase",children:"New"}),s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[u.platform==="instagram"?s.jsx("i",{className:"ri-instagram-fill text-pink-500 text-lg"}):s.jsx("i",{className:"ri-global-line text-slate-500"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs font-semibold text-slate-700 capitalize",children:u.platform}),s.jsx("span",{className:"text-[10px] text-slate-400",children:Te(u.timestamp)})]})]}),s.jsxs("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full ${u.confidence>.8?"bg-red-100 text-red-600":"bg-orange-100 text-orange-600"}`,children:[Math.round(u.confidence*100),"% Toxic"]})]}),s.jsxs("p",{className:"text-sm text-slate-800 line-clamp-2 leading-relaxed font-medium",children:['"',u.content,'"']}),s.jsxs("div",{className:"mt-2 text-[10px] text-slate-400 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"bg-slate-100 px-1.5 py-0.5 rounded capitalize",children:u.label||"hate_speech"})}),u.url&&s.jsx("i",{className:"ri-external-link-line opacity-0 group-hover:opacity-100 transition-opacity"})]})]},j))})]})]}),s.jsx("div",{className:"p-3 text-center text-[10px] text-slate-400 bg-slate-100 border-t border-slate-200",children:"v1.2.0 â€¢ Powered by Cortex AI"})]}):s.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-slate-50 p-6",children:s.jsxs("div",{className:"w-full max-w-xs bg-white p-6 rounded-xl shadow-lg",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"p-3 bg-indigo-100 rounded-full text-indigo-600",children:s.jsx("i",{className:`ri-${f?"user-add-line":"shield-check-fill"} text-3xl`})})}),s.jsx("h1",{className:"text-xl font-bold text-center text-slate-800 mb-6",children:f?"Create Account":"Welcome Back"}),s.jsxs("form",{onSubmit:$,className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("i",{className:"ri-mail-line absolute left-3 top-3 text-slate-400"}),s.jsx("input",{type:"text",placeholder:"Email",className:"w-full pl-10 p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all",value:n,onChange:u=>a(u.target.value)})]}),s.jsxs("div",{className:"relative",children:[s.jsx("i",{className:"ri-lock-line absolute left-3 top-3 text-slate-400"}),s.jsx("input",{type:"password",placeholder:"Password",className:"w-full pl-10 p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all",value:o,onChange:u=>r(u.target.value)})]}),s.jsxs("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium p-2.5 rounded-lg transition-colors flex items-center justify-center gap-2",children:[s.jsx("span",{children:f?"Sign Up":"Sign In"}),s.jsx("i",{className:"ri-arrow-right-line"})]}),s.jsx("div",{className:"text-center mt-4",children:s.jsx("button",{type:"button",onClick:()=>c(!f),className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:f?"Already have an account? Sign In":"Don't have an account? Sign Up"})})]})]})})}Y.createRoot(document.getElementById("root")).render(s.jsx(H.StrictMode,{children:s.jsx(Ae,{})}));
