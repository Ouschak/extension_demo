var c=Object.defineProperty;var i=(n,t,e)=>t in n?c(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var a=(n,t,e)=>i(n,typeof t!="symbol"?t+"":t,e);const h="http://localhost:8000/api/v1";class l{constructor(t=h){a(this,"baseUrl");this.baseUrl=t}async analyzeText(t){try{const e=await fetch(`${this.baseUrl}/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})});if(!e.ok)throw new Error(`API error: ${e.status}`);return await e.json()}catch(e){throw console.error("[CreatorShield] API analyze error:",e),e}}async logDetection(t){try{const e=await chrome.storage.local.get("auth_token").then(s=>s.auth_token),r={"Content-Type":"application/json"};e&&(r.Authorization=`Bearer ${e}`);const o=await fetch(`${this.baseUrl}/logs`,{method:"POST",headers:r,body:JSON.stringify({...t})});if(!o.ok)throw new Error(`API error: ${o.status}`)}catch(e){console.error("[CreatorShield] API log error:",e)}}async syncData(){try{const e=(await chrome.storage.local.get("pending_detections")).pending_detections||[];if(e.length===0)return;for(const r of e)await this.logDetection(r);await chrome.storage.local.set({pending_detections:[]})}catch(t){console.error("[CreatorShield] Sync error:",t)}}async getLogs(){try{const t=await chrome.storage.local.get("auth_token").then(o=>o.auth_token),e={"Content-Type":"application/json"};t&&(e.Authorization=`Bearer ${t}`);const r=await fetch(`${this.baseUrl}/logs`,{method:"GET",headers:e});return r.ok?await r.json():[]}catch(t){return console.error("Error fetching logs",t),[]}}async sendFeedback(t,e,r){try{if(!(await fetch(`${this.baseUrl}/feedback`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t,platform:e,correction:r})})).ok)throw new Error("Failed to send feedback")}catch(o){console.error("[CreatorShield] Feedback error:",o)}}}const p=new l;export{p as a};
